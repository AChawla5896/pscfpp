
   /*
   * Construct basis for pseudo-spectral scft.
   */
   template <int D>
   void Basis<D>::makeBasis(const Mesh<D>& mesh, 
                            const UnitCell<D>& unitCell,
                            std::string groupName)
   {
      SpaceGroup<D> group;
      if (groupName == "I") {
         // Create identity group
         group.makeCompleteGroup();
      } else {
         bool foundFile = false;
         {
            std::ifstream in;
            in.open(groupName);
            if (in.is_open()) {
               in >> group;
               UTIL_CHECK(group.isValid());
               foundFile = true;
            } 
         }
         if (!foundFile) {
            std::string filename = makeGroupFileName(D, groupName);
            std::ifstream in;
            in.open(filename);
            if (in.is_open()) {
               in >> group;
               UTIL_CHECK(group.isValid());
            } else {
              UTIL_THROW("Unknown space group");
            }
         } 
      }
      makeBasis(mesh, unitCell, group);
   }

